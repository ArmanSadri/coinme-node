{"version":3,"sources":["../../src/js/Stopwatch.js"],"names":[],"mappings":"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","file":"Stopwatch.js","sourcesContent":["'use strict';\r\n\r\nimport Utility from \"./Utility\";\r\nimport TimeUnit from \"./TimeUnit\";\r\nimport CoreObject from './CoreObject';\r\n\r\nconst MICROSECONDS = TimeUnit.MICROSECONDS;\r\nconst NANOSECONDS = TimeUnit.NANOSECONDS;\r\n\r\n/**\r\n *\r\n * @type {Ticker}\r\n */\r\nvar SYSTEM_TICKER = null;\r\n\r\nclass Ticker {\r\n\r\n    /**\r\n     * Constructor for use by subclasses.\r\n     */\r\n    constructor(options) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns the number of nanoseconds elapsed since this ticker's fixed\r\n     * point of reference.\r\n     */\r\n    read() {\r\n        let time = process.hrtime();\r\n        let timeInSeconds = time[0];\r\n        let timeInNanos = time[1];\r\n\r\n        return TimeUnit.SECONDS.toNanos(timeInSeconds) + timeInNanos;\r\n    }\r\n\r\n    /**\r\n     * A ticker that reads the current time using {@link System#nanoTime}.\r\n     *\r\n     * @return {Ticker}\r\n     */\r\n    static systemTicker() {\r\n        return SYSTEM_TICKER;\r\n    }\r\n}\r\n\r\nSYSTEM_TICKER = new Ticker();\r\n\r\nclass Stopwatch extends CoreObject {\r\n\r\n    /**\r\n     *\r\n     * @param {Object} options\r\n     * @param {Ticker} [options.ticker]\r\n     * @param {boolean} [options.start]\r\n     */\r\n    constructor(options) {\r\n        super();\r\n\r\n        this._ticker = Utility.take(options, 'ticker') || SYSTEM_TICKER;\r\n        this._isRunning = Utility.take(options, 'start');\r\n        this._elapsedNanos;\r\n        this._startTick;\r\n\r\n        if (this.isRunning) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Number}\r\n     */\r\n    get startTick() {\r\n        return this._startTick;\r\n    }\r\n\r\n    /**\r\n     * @returns {Ticker}\r\n     */\r\n    get ticker() {\r\n        return this._ticker;\r\n    }\r\n\r\n    /**\r\n     * Returns {@code true} if {@link #start()} has been called on this stopwatch,\r\n     * and {@link #stop()} has not been called since the last call to {@code\r\n     * start()}.\r\n     */\r\n    get isRunning() {\r\n        return this._isRunning;\r\n    }\r\n\r\n    /**\r\n     * Starts the stopwatch.\r\n     *\r\n     * @return {Stopwatch}\r\n     */\r\n    start() {\r\n        Utility.shouldBeFalsey(this.isRunning, \"This stopwatch is already running.\");\r\n\r\n        this._isRunning = true;\r\n        this._startTick = this.ticker.read();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Stops the stopwatch. Future reads will return the fixed duration that had\r\n     * elapsed up to this point.\r\n     *\r\n     * @return {Stopwatch} instance\r\n     * @throws IllegalStateException if the stopwatch is already stopped.\r\n     */\r\n    stop() {\r\n        Utility.shouldBeTrue(this.isRunning, \"This stopwatch is already stopped.\");\r\n\r\n        this._isRunning = false;\r\n        this._elapsedNanos += this.ticker.read() - this._startTick;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the elapsed time for this stopwatch to zero,\r\n     * and places it in a stopped state.\r\n     *\r\n     * @return {Stopwatch} instance\r\n     */\r\n    reset() {\r\n        this._elapsedNanos = 0;\r\n        this._isRunning = false;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    elapsedNanos() {\r\n        return this.isRunning ? this.ticker.read() - this._startTick + this.elapsedNanos : this.elapsedNanos;\r\n    }\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    elapsedMicros() {\r\n        return this.elapsed(MICROSECONDS);\r\n    }\r\n\r\n    /**\r\n     * Returns the current elapsed time shown on this stopwatch, expressed\r\n     * in the desired time unit, with any fraction rounded down.\r\n     *\r\n     * <p>Note that the overhead of measurement can be more than a microsecond, so\r\n     * it is generally not useful to specify {@link TimeUnit#NANOSECONDS}\r\n     * precision here.\r\n     *\r\n     * @param {TimeUnit} [timeUnit]\r\n     * @return {Number}\r\n     */\r\n    elapsed(timeUnit) {\r\n        if (!timeUnit) {\r\n            timeUnit = NANOSECONDS;\r\n        }\r\n\r\n        return timeUnit.convert(this.elapsedNanos(), TimeUnit.NANOSECONDS);\r\n    }\r\n\r\n    /**\r\n     * Returns a string representation of the current elapsed time.\r\n     */\r\n    toString() {\r\n        let nanos = this.elapsedNanos();\r\n        let unit = this.chooseUnit(nanos);\r\n\r\n        let value = nanos / TimeUnit.NANOSECONDS.convert(1, unit);\r\n\r\n        // Too bad this functionality is not exposed as a regular method call\r\n        return `${value} ${unit.shortName}`;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param {Number} nanos\r\n     * @return {TimeUnit}\r\n     */\r\n    static chooseUnit(nanos) {\r\n        if (TimeUnit.DAYS.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.DAYS;\r\n        }\r\n\r\n        if (TimeUnit.HOURS.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.HOURS;\r\n        }\r\n\r\n        if (TimeUnit.MINUTES.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.MINUTES;\r\n        }\r\n\r\n        if (TimeUnit.SECONDS.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.SECONDS;\r\n        }\r\n\r\n        if (TimeUnit.MILLISECONDS.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.MILLISECONDS;\r\n        }\r\n\r\n        if (TimeUnit.MICROSECONDS.convert(nanos, TimeUnit.NANOSECONDS) > 0) {\r\n            return TimeUnit.MICROSECONDS;\r\n        }\r\n\r\n        return TimeUnit.NANOSECONDS;\r\n    }\r\n}\r\n\r\nexport {Ticker};\r\nexport {Stopwatch};\r\nexport default Stopwatch;"]}